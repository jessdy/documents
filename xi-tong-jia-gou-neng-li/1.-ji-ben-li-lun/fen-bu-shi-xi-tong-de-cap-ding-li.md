# 分布式系统的CAP定理

### CAP 定理

CAP 定理是分布式系统中的基本定理，这个理论表明任何分布式系统最多可以满足以下三个属性中的两个。

* 一致性（**C**onsistency）

{% hint style="info" %}
在分布式系统中的所有数据备份，在同一时刻是否同样的值。
{% endhint %}

* 可用性（**A**vailability）

{% hint style="info" %}
在集群中**一部分节点故障后，集群整体是否还能响应客户端的读写请求**。（对数据更新具备高可用性）
{% endhint %}

* 分区容错性（**P**artition tolerance）

{% hint style="info" %}
即分布式系统**在遇到某节点或网络分区故障的时候，仍然能够对外提供满足一致性和可用性的服务。**
{% endhint %}

CAP 定理指出分布式系统不可能同时满足一致性，可用性和分区容忍性。

### CAP的选择

#### **CA without P：**

如果不要求P（不允许分区），则C（强一致性）和A（可用性）是可以保证的，单机的系统都是可以保证CA的。但放弃P的同时也就意味着放弃了系统的扩展性，也就是分布式节点受限，没办法部署子节点，这是违背分布式系统设计的初衷的。

**CP without A：**

如果不要求A（可用），相当于每个请求都需要在Server之间强一致，而P（分区）会导致同步时间无限延长\(也就是等待数据同步完才能正常访问服务\)，如此CP也是可以保证的。很多传统的数据库分布式事务都属于这种模式。

#### **AP without C：**

要高可用并允许分区，则需放弃一致性。一旦分区发生，节点之间可能会失去联系，为了高可用，每个节点只能用本地数据提供服务，而这样会导致全局数据的不一致性。现在众多的NoSQL都属于此类，如redis,mongdb等。



